{{#> head title="Project"}}
{{/head}}
<body>
  <section>  
    <header>
      <h1>{{line.name}}</h1>
      <span x-text="project.name"></span>
    </header>
    <nav>
      <a href="..">Back</a>
    </nav>
    <form class="grid">
      <input type="hidden" name="project_id" value="{{line.project_id}}"/>
      <input type="hidden" name="id" value="{{line.id}}"/>
      <label class="form-control">
        <span class="label label-text">Title</span>
        <input name="name" class="input input-bordered" autofocus="" required="" value="{{line.name}}" />
      </label>
      <label class="form-control">
        <span class="label label-text">Amount</span>
        <div class="flex gap-2">
          <input name="amount" :value="line.amount"  class="input input-bordered grow" inputmode="decimal" pattern="[0-9.\-]*" type="text" oninput="computeSplit()" required=""  />
          <select name="currency" class="select select-bordered" value="{{line.currency}}"> 
            <option>EUR</option>
            <option>SGD</option>
            <option>USD</option>
          </select>
        </div>
      </label>
      <label class="form-control">
        <span class="label label-text">Date</span>
        <input type="datetime-local" name="created_at" class="input input-bordered" value="{{line.created_at}}" />
      </label>
      <div class="flex gap-2">
        <label class="form-control grow">
          <span class="label label-text">Paid by</span>
          <select name="paid" class="select select-bordered" value="{{line.paid}}">
            {{#each project.participants}}
            <option value="{{this}}">{{this}}</option>
            {{/each}}
          </select>
        </label>
        <label class="flex flex-col items-center">
          <span class="label label-text">Balanced?</span>
          <input type="checkbox" class="toggle toggle-primary mt-3" checked="checked" />
        </label>
      </div>
      <ul class="grid gap-4 mt-4">
        {{#each line.split}}
        {{#if specific}}
        <li class="flex items-center gap-4">
          ???
        </li>
        {{else}}
        <li class="flex items-center gap-4">
          <input id="{{this.participant}}" type="checkbox" class="checkbox"/>
          <label for="'part'+ index" class="flex items-center gap-4 whitespace-nowrap">{{this.participant}}</label>
          <input name="split[{{@index}}][participant]'" value={{this.participant}} type="hidden"/>
          <input name="split[{{@index}}][amount]'" disabled value={{this.amount}} class="input input-bordered w-full" inputmode="numeric" pattern="[0-9.\-]*" type="text"/>
          <span>{{../line.currency}}</span>
        </li>
        {{/if}}
       {{/each}}
      </ul>
      <div class="my-8 flex justify-start gap-8 flex-row-reverse">
        <button class="btn btn-primary">Save</button>
        <button class="btn btn-warning" @click="
          const shouldDelete = confirm('Are you sure you want to delete?')
          if(!shouldDelete) event.preventDefault()
          else line.deletedAt = new Date().toISOString();
        ">Delete</button>
      </div>
    </form>
  </section>
</body>